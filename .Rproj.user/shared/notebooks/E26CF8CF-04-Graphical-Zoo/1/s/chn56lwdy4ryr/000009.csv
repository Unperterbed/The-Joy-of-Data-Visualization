"0","df <- ggplot2::diamonds %>% "
"0","  count(cut, clarity) %>% "
"0","  rename(""Clarity"" = ""clarity"") %>% "
"0","  group_by(cut) %>% "
"0","  mutate(prop_n = n/sum(n))"
"0",""
"0","fig <- "
"0","  df %>% "
"0","  ggplot(aes(x = cut, y = prop_n, fill = Clarity)) + "
"0","  geom_col(position = ""stack"") + "
"0","  labs(x = ""Cut Quality"", y = ""Proportion"", title = ""Proportions of Diamond Color Clarity Within Cut Quality"") + "
"0","  scale_y_continuous(breaks = c(0,.25,.50,.75,1),"
"0","                     labels = c(""0%"", ""25%"", ""50%"", ""75%"", ""100%""))"
"0",""
"0","fig"
